import os
from pathlib import Path
import pandas as pd
import numpy as np

def return_large_files(target, threshold):
    p = Path(target)

    if not p.is_dir():
        raise ValueError(f"{target} is not valid directory")
    
    for file_path in p.rglob("*"):
        try:
            stat = file_path.stat()
            if file_path.is_file() and stat.st_size > threshold:
                size_gb = stat.st_size / 10**9
                print(file_path)
                print(f"{size_gb:.2f} GB")
        except (FileNotFoundError, PermissionError):
            continue


target = Path(r"C:\\")
threshold = 10 ** 9
return_large_files(target, threshold)